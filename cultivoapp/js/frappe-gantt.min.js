window.Gantt = class {
  constructor(selector, tasks) {
    const container = document.querySelector(selector);
    container.innerHTML = "";

    const cores = ["bg-purple-300", "bg-green-300", "bg-blue-300", "bg-yellow-300", "bg-pink-300", "bg-red-300"];
    const cultivos = {};
    let corIndex = 0;

    // Hoje
    const hoje = new Date().toISOString().split("T")[0];
    const hojeDiv = document.createElement("div");
    hojeDiv.className = "w-full text-center my-4 text-sm text-gray-500 font-medium";
    hojeDiv.textContent = `📍 Hoje: ${hoje}`;
    container.appendChild(hojeDiv);

    tasks.forEach(task => {
      // Detecta o cultivo pelo prefixo do ID
      const cultivoId = task.id.split("-")[0];
      if (!cultivos[cultivoId]) {
        cultivos[cultivoId] = cores[corIndex % cores.length];
        corIndex++;
      }

      const cor = cultivos[cultivoId];

      const bar = document.createElement("div");
      bar.className = `${cor} my-2 px-4 py-2 rounded shadow text-sm`;

      const nome = document.createElement("div");
      nome.className = "font-semibold text-gray-800";
      nome.textContent = task.name;

      const datas = document.createElement("div");
      datas.className = "text-gray-700 text-xs";
      datas.textContent = `🗓 ${task.start} → ${task.end}`;

      bar.appendChild(nome);
      bar.appendChild(datas);
      container.appendChild(bar);
    });
  }
};
