<input id="nome-blueprint" placeholder="Nome da Blueprint" value="Minha Blueprint" />

<table id="tabela">
  <thead>
    <tr>
      <th>Evento</th>
      <th>Dias</th>
      <th>Ajuste (dias)</th>
      <th>Notas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td contenteditable>Clonar</td>
      <td contenteditable>1</td>
      <td contenteditable>0</td>
      <td contenteditable></td>
    </tr>
    <!-- (adicione os demais eventos com estrutura similar) -->
  </tbody>
</table>

<button id="salvar">Salvar</button>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-auth.js";
  import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";

  const app = initializeApp({
    apiKey: "AIzaSyCo7MOVfaalrDg0o0GpYJ4-YNL4OCrjfXE",
    authDomain: "jungle-brothers-938e0.firebaseapp.com",
    projectId: "jungle-brothers-938e0",
    appId: "1:221354970870:web:a7f68c75480dc094bbad67"
  });

  const auth = getAuth(app);
  const db = getFirestore(app);

  let currentUser;

  onAuthStateChanged(auth, user => {
    if (!user) {
      location.href = "/login.html";
    } else {
      currentUser = user;
    }
  });

  document.getElementById("salvar").addEventListener("click", async () => {
    const nome = document.getElementById("nome-blueprint").value;
    const linhas = document.querySelectorAll("#tabela tbody tr");
    const eventos = [];

    linhas.forEach(linha => {
      const [evento, dias, ajuste, notas] = [...linha.cells].map(td => td.innerText.trim());
      eventos.push({ evento, dias: parseInt(dias), ajuste: parseInt(ajuste), notas });
    });

    const ref = doc(db, "blueprints", currentUser.uid);
    await setDoc(ref, {
      [nome]: eventos
    }, { merge: true });

    alert("Blueprint salva!");
  });
</script>
